<!-- templates/contributors_dashboard.html — FULL SCRIPT (admin view) -->
{% extends "base.html" %}
{% block title %}Contributors Dashboard • Nautical Compass{% endblock %}

{% block content %}
<div class="card">
  <h2>Contributors Dashboard</h2>
  <p class="muted">
    Filter by rail / score / track. (Protected by admin key in the URL: <code>?key=...</code>)
  </p>

  <form class="form" method="get" action="/admin/contributors-dashboard">
    <input type="hidden" name="key" value="{{ request.query_params.get('key','') }}"/>

    <div class="grid grid-3">
      <div>
        <label class="label">Rail</label>
        <input name="rail" value="{{ rail or '' }}" placeholder="sales_priority, staff_pool, etc." />
      </div>
      <div>
        <label class="label">Min score</label>
        <input name="min_score" value="{{ min_score if min_score is not none else '' }}" placeholder="45" />
      </div>
      <div>
        <label class="label">Track</label>
        <input name="track" value="{{ track or '' }}" placeholder="sales_growth, ecosystem_staff..." />
      </div>
    </div>

    <div class="btnrow">
      <button class="btn btn-primary" type="submit">Apply Filters</button>
      <a class="btn" href="/admin/contributors-dashboard?key={{ request.query_params.get('key','') }}">Clear</a>
    </div>
  </form>
</div>

<div class="card" style="margin-top:18px;">
  <h3>Contributors</h3>
  <p class="muted">Showing {{ contributors|length }} results.</p>

  <div style="overflow:auto; border:1px solid rgba(255,255,255,.10); border-radius:14px;">
    <table style="width:100%; border-collapse:collapse; min-width:950px;">
      <thead>
        <tr style="background:rgba(255,255,255,.04);">
          <th style="text-align:left; padding:10px;">ID</th>
          <th style="text-align:left; padding:10px;">Name</th>
          <th style="text-align:left; padding:10px;">Email</th>
          <th style="text-align:left; padding:10px;">Track</th>
          <th style="text-align:left; padding:10px;">Rail</th>
          <th style="text-align:left; padding:10px;">Score</th>
          <th style="text-align:left; padding:10px;">Status</th>
          <th style="text-align:left; padding:10px;">Update</th>
        </tr>
      </thead>
      <tbody>
        {% for c in contributors %}
        <tr style="border-top:1px solid rgba(255,255,255,.08);">
          <td style="padding:10px;">{{ c.id }}</td>
          <td style="padding:10px;">{{ c.name }}</td>
          <td style="padding:10px;">{{ c.email }}</td>
          <td style="padding:10px;">{{ c.contribution_track }}</td>
          <td style="padding:10px;"><span class="badge">{{ c.rail }}</span></td>
          <td style="padding:10px;">{{ c.score }}</td>
          <td style="padding:10px;">{{ c.status }}</td>
          <td style="padding:10px;">
            <form method="post" action="/admin/contributor-status?key={{ request.query_params.get('key','') }}">
              <input type="hidden" name="id" value="{{ c.id }}"/>
              <select name="status">
                <option {% if c.status == "new" %}selected{% endif %}>new</option>
                <option {% if c.status == "contacted" %}selected{% endif %}>contacted</option>
                <option {% if c.status == "invited" %}selected{% endif %}>invited</option>
                <option {% if c.status == "active" %}selected{% endif %}>active</option>
                <option {% if c.status == "archived" %}selected{% endif %}>archived</option>
              </select>
              <button class="btn" type="submit" style="padding:8px 12px;">Save</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
